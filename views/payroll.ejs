<%- include('partials/header'); -%>

       <div class="payroll-section">
              <div class="overlay <%= AddOverlay %>"></div>
              <div class="container-fluid">
                     <div class="row">
                            <div class="col">
                                   <div class="container-fluid px-4 pt-4">
                                          <h5>Payroll</h5>
                                   </div>






                                   <!-- ##############################################
                                                  User input Field
                                   ################################################ -->
                                   <div class="container">
                                          <div class="user-input bg-primary">

                                                 <div class="container-fluid">
                                                        <div class="col-1">
                                                               <button class="btn btn-danger close-form">Close</button>
                                                        </div>
                                                        <div class="row">
                                                               <form id="empform" action="/payroll" method="post">
                                                                      <div class="col">
                                                                             <table class="table table-info">
                                                                                    <thead>
                                                                                           <tr>
                                                                                                  <th scope="col">Name
                                                                                                         of Emp
                                                                                                  </th>
                                                                                                  <th scope="col">Staff
                                                                                                         ID</th>
                                                                                                  <th scope="col">Tin
                                                                                                         No.</th>
                                                                                                  <th scope="col">
                                                                                                         Position</th>

                                                                                                  <th scope="col">SSF
                                                                                                         No.</th>
                                                                                                  <th scope="col">Bank
                                                                                                         and
                                                                                                         Branch</th>
                                                                                           </tr>
                                                                                    </thead>
                                                                                    <tbody>
                                                                                           <tr>
                                                                                                  <div>
                                                                                                         <td>

                                                                                                                <input type="text"
                                                                                                                       class="form-control"
                                                                                                                       name="empName"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="text"
                                                                                                                       class="form-control"
                                                                                                                       name="staffID"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="tinNumber"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="text"
                                                                                                                       class="form-control"
                                                                                                                       name="position"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="ssfNumber"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="text"
                                                                                                                       class="form-control"
                                                                                                                       name="bank"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>

                                                                                                  </div>
                                                                                           </tr>
                                                                                    </tbody>
                                                                             </table>
                                                                      </div>
                                                                      <div class="col">
                                                                             <table class="table table-info">
                                                                                    <thead>
                                                                                           <tr>
                                                                                                  <th scope="col">Bank
                                                                                                         Account
                                                                                                         No.</th>
                                                                                                  <th scope="col">Basic
                                                                                                         Salary
                                                                                                         (Gh₵)
                                                                                                  </th>
                                                                                                  <th scope="col">
                                                                                                         Taxable
                                                                                                         Allowances
                                                                                                         (Gh₵)</th>
                                                                                                  <th scope="col">
                                                                                                         Non-Taxable
                                                                                                         Allowances
                                                                                                         (Gh₵)</th>

                                                                                                  <th scope="col">Total
                                                                                                         Reliefs
                                                                                                         (Gh₵)
                                                                                                  </th>
                                                                                                  <th scope="col">Other
                                                                                                         Deductions
                                                                                                         (Gh₵)</th>
                                                                                           </tr>
                                                                                    </thead>
                                                                                    <tbody>
                                                                                           <tr>
                                                                                                  <div>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="bankAccountNo"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="basicSalary"
                                                                                                                       autocomplete="off"
                                                                                                                       required>
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="taxAllowances"
                                                                                                                       autocomplete="off"
                                                                                                                       value="0">
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="nonTaxAllowances"
                                                                                                                       autocomplete="off"
                                                                                                                       value="0">
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="totalReliefs"
                                                                                                                       autocomplete="off"
                                                                                                                       value="0">
                                                                                                         </td>
                                                                                                         <td>

                                                                                                                <input type="number"
                                                                                                                       class="form-control"
                                                                                                                       name="otherDeductions"
                                                                                                                       autocomplete="off"
                                                                                                                       value="0">
                                                                                                         </td>
                                                                                                  </div>
                                                                                           </tr>
                                                                                    </tbody>
                                                                             </table>
                                                                      </div>
                                                                      <button type="submit"
                                                                             class="btn btn-outline-light px-4"
                                                                             onclick="empForm()">Save</button>
                                                               </form>
                                                        </div>
                                                 </div>
                                          </div>
                                   </div>

                                   <% if(EmployeePayrollData.length===0) { %>
                                          <div class="container no-data">
                                                 <div class="row">
                                                        <div class="col-lg-12">
                                                               <img src="/images/no_data.jpg" alt="No data image">
                                                        </div>
                                                 </div>
                                                 <!-- #####################################################
                                                                Btn for Showing Input field
                                                 ###################################################### -->
                                                 <div class="container-fluid my-2">
                                                        <div class="row no-data-btn">
                                                               <div class="col-12">
                                                                      <button class="btn btn-primary add-new">+
                                                                             Add
                                                                             New Employee</button>
                                                               </div>
                                                        </div>
                                                 </div>
                                          </div>
                                          <%} else {%>

                                                 <!-- #####################################
                                                           Search bar 
                                                  ####################################### -->
                                                 <div class="container">
                                                        <form class="d-flex search-bar">
                                                               <input class="form-control me-2" type="search"
                                                                      placeholder="Search employee name, position, id...."
                                                                      aria-label="Search">
                                                               <button class="btn btn-primary"
                                                                      type="submit">Search</button>
                                                        </form>
                                                 </div>

                                                 <!-- #####################################################
                                                                 Btn for Showing Input field
                                                 ###################################################### -->
                                                 <div class="container-fluid my-2">
                                                        <div class="row">
                                                               <div class="col-11">
                                                                      <button class="btn btn-secondary add-new">+
                                                                             Add
                                                                             New Employee</button>
                                                               </div>
                                                        </div>
                                                 </div>
                                                 <!-- #####################################################
                                                                           Table
                                                 ##################################################### -->
                                                 <div class=" container payroll-table">
                                                        <div class="container-fluid">
                                                               <div class="row">
                                                                      <div class="col">
                                                                             <table class="table">
                                                                                    <thead>
                                                                                           <tr>
                                                                                                  <th scope="col">#</th>
                                                                                                  <th scope="col">Name
                                                                                                         of Emp</th>
                                                                                                  <th scope="col">Staff
                                                                                                         ID</th>
                                                                                                  <th scope="col">
                                                                                                         Position</th>
                                                                                                  <th scope="col">Basic
                                                                                                         Salary
                                                                                                         <br><span
                                                                                                                class="currency">(Gh₵)</span>
                                                                                                  </th>
                                                                                                  <th scope="col">SSF
                                                                                                         (5.5%)
                                                                                                         <br><span
                                                                                                                class="currency">(Gh₵)</span>
                                                                                                  </th>
                                                                                                  <th scope="col">
                                                                                                         Taxable Salary
                                                                                                         <br><span
                                                                                                                class="currency">(Gh₵)</span>
                                                                                                  </th>
                                                                                                  <th scope="col">Paye
                                                                                                         <br><span
                                                                                                                class="currency">(Gh₵)</span>
                                                                                                  </th>
                                                                                                  <th scope="col">Net
                                                                                                         Salary
                                                                                                         <br><span
                                                                                                                class="currency">(Gh₵)</span>
                                                                                                  </th>
                                                                                           </tr>
                                                                                    </thead>

                                                                                    <tbody>


                                                                                           <% for (let
                                                                                                  i=0;i<EmployeePayrollData.length;
                                                                                                  i++) { %>

                                                                                                  <tr>
                                                                                                         <th
                                                                                                                scope="row">
                                                                                                                <%= i +1
                                                                                                                       %>
                                                                                                         </th>
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].Employee_name
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].Staff_id
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].Position
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].Basic_salary
                                                                                                                       %>
                                                                                                         </td>


                                                                                                         <!-- /////////////// Calculations Results //////////////// -->
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].SSF
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%=EmployeePayrollData[i].Taxable_salary
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%=EmployeePayrollData[i].Payee
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <%= EmployeePayrollData[i].Net_Salary
                                                                                                                       %>
                                                                                                         </td>
                                                                                                         <td>
                                                                                                                <form action="/employee-payroll-details"
                                                                                                                       method="post">
                                                                                                                       <button class="btn btn-info text-white"
                                                                                                                              name="empID"
                                                                                                                              value="<%= EmployeePayrollData[i].ID %>">More
                                                                                                                              Info</button>
                                                                                                                </form>
                                                                                                         </td>


                                                                                                  </tr>
                                                                                                  <% } %>

                                                                                    </tbody>
                                                                             </table>
                                                                      </div>
                                                               </div>
                                                        </div>
                                                 </div>
                                                 <%} %>

                                                        <!-- ///////////////////////////////////////////////////////////////////////////
                                                                        Details of Payroll Form
                                                        /////////////////////////////////////////////////////////////////////////////// -->
                                                        <div class="cotainer employee-payroll-form">
                                                               <% EmployeeDataFound.forEach(employee=> { %>
                                                                      <div
                                                                             class="container payroll-form-content <%=OpenPayrollForm %>">
                                                                             <!-- ################ 
                                                                                    Close Button
                                                                             ####################### -->
                                                                             <div class="row">
                                                                                    <div
                                                                                           class="col d-flex close-form-btn">
                                                                                           <h5>Payroll for <%=
                                                                                                         EmployeeDataFound[0].Employee_name
                                                                                                         %>
                                                                                           </h5>
                                                                                           <button class="btn btn-danger payroll-form-btn"
                                                                                                  onclick="closePayrollForm()">Close</button>
                                                                                    </div>
                                                                             </div>
                                                                             <hr>

                                                                             <!-- ####################################################
                                                                                    More information about the Selected Employee on Payroll
                                                                             ####################################################### -->
                                                                             <div class="row payroll-form-view">
                                                                                    <div class="col">

                                                                                           <div>
                                                                                                  <table class="table">
                                                                                                         <tbody>
                                                                                                                <tr>
                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Staff
                                                                                                                              Id
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Staff_id
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Positio
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Position
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>
                                                                                                                <tr>
                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Tin
                                                                                                                              Number
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Tin_number
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Bank
                                                                                                                              Name
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].BankBranch_BankName
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>

                                                                                                                <tr>
                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Bank
                                                                                                                              Account
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Bank_account_number
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th
                                                                                                                              scope="row">
                                                                                                                              Basic
                                                                                                                              Salary
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Basic_salary
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>
                                                                                                                <tr>
                                                                                                                       <th>SSF(5.5%)
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].SSF
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th>Taxable
                                                                                                                              Salary
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Taxable_salary
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>
                                                                                                                <tr>
                                                                                                                       <th>Total
                                                                                                                              Reliefs
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Total_reliefs
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th>Payee
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Payee
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>

                                                                                                                <tr>
                                                                                                                       <th>Non Taxable
                                                                                                                              Salary
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Non_taxable_allowance
                                                                                                                                     %>
                                                                                                                       </td>

                                                                                                                       <th>Other
                                                                                                                              Deductions
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Other_deductions
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>

                                                                                                                <tr>
                                                                                                                       <th>Net Salary
                                                                                                                       </th>
                                                                                                                       <td>
                                                                                                                              <%= EmployeeDataFound[0].Net_Salary
                                                                                                                                     %>
                                                                                                                       </td>
                                                                                                                </tr>
                                                                                                         </tbody>
                                                                                                  </table>
                                                                                           </div>

                                                                                           <div
                                                                                                  class="d-flex opened-form-btn">
                                                                                                  <form action="/edit-employee-payroll-data"
                                                                                                         method="post">
                                                                                                         <button class="btn btn-success text-white"
                                                                                                                name="empID"
                                                                                                                value="<%= EmployeeDataFound[0].ID %>">Edit
                                                                                                                Employee</button>
                                                                                                  </form>
                                                                                           </div>
                                                                                    </div>
                                                                             </div>
                                                                      </div>
                                                                      <% }) %>
                                                        </div>
                            </div>
                     </div>
              </div>
       </div>

       <%- include('partials/footer'); -%>